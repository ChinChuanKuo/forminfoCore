// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE

import * as List from "bs-platform/lib/es6/list.js";
import * as $$Array from "bs-platform/lib/es6/array.js";
import * as Block from "bs-platform/lib/es6/block.js";
import * as Curry from "bs-platform/lib/es6/curry.js";
import * as React from "react";
import * as Caml_obj from "bs-platform/lib/es6/caml_obj.js";
import * as Caml_array from "bs-platform/lib/es6/caml_array.js";
import * as ReactIntl from "react-intl";
import * as Tab$BtsCore from "../../material-ui/core/Tabs/Tab.bs.js";
import * as Card$BtsCore from "../../material-ui/core/Card/Card.bs.js";
import * as Data$BtsCore from "../../features/Data.bs.js";
import * as Path$BtsCore from "../../features/Path.bs.js";
import * as Tabs$BtsCore from "../../material-ui/core/Tabs/Tabs.bs.js";
import * as Icons$BtsCore from "../../material-ui/icon/Icons.bs.js";
import * as Button$BtsCore from "../../material-ui/core/Button/Button.bs.js";
import * as Status$BtsCore from "../../features/Status.bs.js";
import * as Switch$BtsCore from "../../material-ui/core/Switch/Switch.bs.js";
import * as Divider$BtsCore from "../../material-ui/core/Divider/Divider.bs.js";
import * as Tooltip$BtsCore from "../../material-ui/core/Tooltip/Tooltip.bs.js";
import * as Axiosapi$BtsCore from "../../features/Axiosapi.bs.js";
import * as GridItem$BtsCore from "../../material-ui/core/Grid/GridItem.bs.js";
import * as MenuIcon$BtsCore from "../../material-ui/core/MenuItem/MenuIcon.bs.js";
import * as MenuItem$BtsCore from "../../material-ui/core/MenuItem/MenuItem.bs.js";
import * as Together$BtsCore from "../../styles/Together/Together.bs.js";
import * as ReasonReactRouter from "reason-react/src/ReasonReactRouter.js";
import * as DialogFull$BtsCore from "../../material-ui/core/Dialog/DialogFull.bs.js";
import * as IconAction$BtsCore from "../../material-ui/core/IconStyle/IconAction.bs.js";
import * as IconButton$BtsCore from "../../material-ui/core/IconButton/IconButton.bs.js";
import * as SelectMenu$BtsCore from "../../material-ui/core/Menu/SelectMenu.bs.js";
import * as Typography$BtsCore from "../../material-ui/core/Typography/Typography.bs.js";
import * as AnswerColor$BtsCore from "../../controls/AnswerColor.bs.js";
import * as DialogTitle$BtsCore from "../../material-ui/core/Dialog/DialogTitle.bs.js";
import * as IconGeneral$BtsCore from "../../material-ui/core/IconStyle/IconGeneral.bs.js";
import * as ImageUpload$BtsCore from "../../example/Uploads/ImageUpload.bs.js";
import * as NewFacetube$BtsCore from "../../example/Facebook/NewFacetube.bs.js";
import * as SwitchColor$BtsCore from "../../controls/SwitchColor.bs.js";
import * as CircleButton$BtsCore from "../../material-ui/core/Button/CircleButton.bs.js";
import * as DialogActions$BtsCore from "../../material-ui/core/Dialog/DialogActions.bs.js";
import * as DialogContent$BtsCore from "../../material-ui/core/Dialog/DialogContent.bs.js";
import * as GeneralUpload$BtsCore from "../../example/Uploads/GeneralUpload.bs.js";
import * as GridContainer$BtsCore from "../../material-ui/core/Grid/GridContainer.bs.js";
import * as IconAnimation$BtsCore from "../../controls/IconAnimation.bs.js";
import * as SelectOutline$BtsCore from "../../material-ui/core/Select/SelectOutline.bs.js";
import * as ExpansionBasis$BtsCore from "../../material-ui/core/ExpansionPanel/ExpansionBasis.bs.js";
import * as ExpansionPanel$BtsCore from "../../material-ui/core/ExpansionPanel/ExpansionPanel.bs.js";
import * as SelectStandard$BtsCore from "../../material-ui/core/Select/SelectStandard.bs.js";
import * as BackgroundBoard$BtsCore from "../../example/Boards/BackgroundBoard.bs.js";
import * as SnackbarYoutube$BtsCore from "../../material-ui/core/Snackbar/SnackbarYoutube.bs.js";
import * as CardOrPaperBoard$BtsCore from "../../example/Boards/CardOrPaperBoard.bs.js";
import * as ExpansionSummary$BtsCore from "../../material-ui/core/ExpansionPanel/ExpansionSummary.bs.js";
import * as TextFieldOutline$BtsCore from "../../material-ui/core/TextField/TextFieldOutline.bs.js";
import * as DialogContentText$BtsCore from "../../material-ui/core/Dialog/DialogContentText.bs.js";
import * as TextFieldStandard$BtsCore from "../../material-ui/core/TextField/TextFieldStandard.bs.js";
import * as TextFieldMultiline$BtsCore from "../../material-ui/core/TextField/TextFieldMultiline.bs.js";
import * as DialogAnimationRight$BtsCore from "../../material-ui/core/Dialog/DialogAnimationRight.bs.js";

((require('../../../scss/pages/Together/together.scss')));

function newitem(iid, opticonitems) {
  return [{
            iid: iid,
            showLine: false,
            title: "",
            showOut: false,
            showVeri: false,
            showDrop: false,
            showFile: false,
            outValue: "radio",
            type_: "",
            showType: false,
            typeitems: [],
            operation: "",
            showOperation: false,
            operationitems: [],
            area: "",
            eror: "",
            showCheck: false,
            showMore: false,
            opticonitems: opticonitems,
            answeritems: [{
                id: 1,
                value: "",
                showAnswer: false,
                ansrDelete: false,
                ansrModify: false,
                ansrCreate: true
              }],
            formDelete: false,
            formModify: false,
            formCreate: true
          }];
}

function newansweritem(id) {
  return [{
            id: id,
            value: "",
            showAnswer: false,
            ansrDelete: false,
            ansrModify: false,
            ansrCreate: true
          }];
}

function reducer(state, action) {
  if (typeof action === "number") {
    switch (action) {
      case /* SettingError */0 :
          var newrecord = Caml_obj.caml_obj_dup(state);
          newrecord.error = !state.error;
          return newrecord;
      case /* SettingFormLoad */1 :
          var newrecord$1 = Caml_obj.caml_obj_dup(state);
          newrecord$1.formLoad = !state.formLoad;
          return newrecord$1;
      case /* ActionShowProgress */2 :
          var newrecord$2 = Caml_obj.caml_obj_dup(state);
          newrecord$2.showProgress = !state.showProgress;
          return newrecord$2;
      case /* ShowAnimationRight */3 :
          var newrecord$3 = Caml_obj.caml_obj_dup(state);
          newrecord$3.showFile = false;
          newrecord$3.showDrop = false;
          newrecord$3.showRight = !state.showRight;
          return newrecord$3;
      case /* ShowFile */4 :
          var newrecord$4 = Caml_obj.caml_obj_dup(state);
          newrecord$4.showFile = !state.showFile;
          return newrecord$4;
      case /* CloseAnimationRight */5 :
          var newrecord$5 = Caml_obj.caml_obj_dup(state);
          newrecord$5.showRight = !state.showRight;
          return newrecord$5;
      case /* CloseAnimationFull */6 :
          var newrecord$6 = Caml_obj.caml_obj_dup(state);
          newrecord$6.showFull = !state.showFull;
          return newrecord$6;
      
    }
  } else {
    switch (action.tag | 0) {
      case /* SettingFormWidth */0 :
          var newrecord$7 = Caml_obj.caml_obj_dup(state);
          newrecord$7.formHeight = action[1];
          newrecord$7.formWidth = action[0];
          return newrecord$7;
      case /* ActionPermissItems */1 :
          var newrecord$8 = Caml_obj.caml_obj_dup(state);
          newrecord$8.export = action[3];
          newrecord$8.delete = action[2];
          newrecord$8.update = action[1];
          newrecord$8.insert = action[0];
          return newrecord$8;
      case /* SettingFormPolls */2 :
          var newrecord$9 = Caml_obj.caml_obj_dup(state);
          newrecord$9.items = $$Array.append(state.items, action[1]);
          newrecord$9.itemCount = state.itemCount + action[0] | 0;
          return newrecord$9;
      case /* SettingFormItems */3 :
          var newrecord$10 = Caml_obj.caml_obj_dup(state);
          newrecord$10.items = action[1];
          newrecord$10.itemCount = action[0];
          return newrecord$10;
      case /* SettingSettItems */4 :
          var newrecord$11 = Caml_obj.caml_obj_dup(state);
          newrecord$11.settitems = action[0];
          return newrecord$11;
      case /* ClickItemTab */5 :
          var index = action[0];
          var newrecord$12 = Caml_obj.caml_obj_dup(state);
          newrecord$12.index = index;
          newrecord$12.tabitems = List.mapi((function (i, tabtitem) {
                  return {
                          showTabt: index === i,
                          tabImage: tabtitem.tabImage,
                          tabPath: tabtitem.tabPath
                        };
                }), state.tabitems);
          return newrecord$12;
      case /* ShowDrop */6 :
          var newrecord$13 = Caml_obj.caml_obj_dup(state);
          newrecord$13.showDrop = action[0];
          return newrecord$13;
      case /* ShowAnimationFull */7 :
          var newrecord$14 = Caml_obj.caml_obj_dup(state);
          newrecord$14.settitems = action[4];
          newrecord$14.formitems = action[3];
          newrecord$14.formindex = 0;
          newrecord$14.formDesc = action[2];
          newrecord$14.formTile = action[1];
          newrecord$14.formId = action[0];
          newrecord$14.showFull = !state.showFull;
          return newrecord$14;
      case /* SettingViewItems */8 :
          var newrecord$15 = Caml_obj.caml_obj_dup(state);
          newrecord$15.viewitems = action[0];
          return newrecord$15;
      case /* ChangeFormTile */9 :
          var newrecord$16 = Caml_obj.caml_obj_dup(state);
          newrecord$16.formTile = action[0];
          return newrecord$16;
      case /* ChangeFormDesc */10 :
          var newrecord$17 = Caml_obj.caml_obj_dup(state);
          newrecord$17.formDesc = action[0];
          return newrecord$17;
      case /* ClickFormTab */11 :
          var index$1 = action[0];
          var newrecord$18 = Caml_obj.caml_obj_dup(state);
          newrecord$18.formindex = index$1;
          newrecord$18.formtabitems = List.mapi((function (i, tabitem) {
                  return {
                          showTab: index$1 === i,
                          tabImage: tabitem.tabImage
                        };
                }), state.formtabitems);
          return newrecord$18;
      case /* ClickBoardPaper */12 :
          var index$2 = action[0];
          var newrecord$19 = Caml_obj.caml_obj_dup(state);
          newrecord$19.formitems = $$Array.mapi((function (i, item) {
                  var newrecord = Caml_obj.caml_obj_dup(item);
                  newrecord.showLine = index$2 === i;
                  return newrecord;
                }), state.formitems);
          return newrecord$19;
      case /* ChangeTile */13 :
          var index$3 = action[1];
          var value = action[0];
          var newrecord$20 = Caml_obj.caml_obj_dup(state);
          newrecord$20.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$3 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.title = value;
                  return newrecord;
                }), state.formitems);
          return newrecord$20;
      case /* ShowOut */14 :
          var index$4 = action[0];
          var newrecord$21 = Caml_obj.caml_obj_dup(state);
          newrecord$21.formitems = $$Array.mapi((function (i, formitem) {
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showOut = index$4 === i ? !formitem.showOut : false;
                  return newrecord;
                }), state.formitems);
          return newrecord$21;
      case /* ShowValue */15 :
          var index$5 = action[1];
          var outValue = action[0];
          var newrecord$22 = Caml_obj.caml_obj_dup(state);
          newrecord$22.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$5 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.outValue = outValue;
                  newrecord.showOut = false;
                  return newrecord;
                }), state.formitems);
          return newrecord$22;
      case /* ChangeText */16 :
          var index$6 = action[2];
          var rindex = action[1];
          var value$1 = action[0];
          var newrecord$23 = Caml_obj.caml_obj_dup(state);
          newrecord$23.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$6 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.answeritems = $$Array.mapi((function (ri, answeritem) {
                          if (rindex === ri) {
                            return {
                                    id: answeritem.id,
                                    value: value$1,
                                    showAnswer: answeritem.showAnswer,
                                    ansrDelete: answeritem.ansrDelete,
                                    ansrModify: true,
                                    ansrCreate: answeritem.ansrCreate
                                  };
                          } else {
                            return answeritem;
                          }
                        }), formitem.answeritems);
                  return newrecord;
                }), state.formitems);
          return newrecord$23;
      case /* ClickRadio */17 :
          var index$7 = action[1];
          var rindex$1 = action[0];
          var newrecord$24 = Caml_obj.caml_obj_dup(state);
          newrecord$24.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$7 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.answeritems = $$Array.mapi((function (ri, answeritem) {
                          return {
                                  id: answeritem.id,
                                  value: answeritem.value,
                                  showAnswer: rindex$1 === ri ? !answeritem.showAnswer : false,
                                  ansrDelete: answeritem.ansrDelete,
                                  ansrModify: true,
                                  ansrCreate: answeritem.ansrCreate
                                };
                        }), formitem.answeritems);
                  return newrecord;
                }), state.formitems);
          return newrecord$24;
      case /* ClickCheckbox */18 :
          var index$8 = action[1];
          var rindex$2 = action[0];
          var newrecord$25 = Caml_obj.caml_obj_dup(state);
          newrecord$25.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$8 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.answeritems = $$Array.mapi((function (ri, answeritem) {
                          if (rindex$2 === ri) {
                            return {
                                    id: answeritem.id,
                                    value: answeritem.value,
                                    showAnswer: !answeritem.showAnswer,
                                    ansrDelete: answeritem.ansrDelete,
                                    ansrModify: true,
                                    ansrCreate: answeritem.ansrCreate
                                  };
                          } else {
                            return answeritem;
                          }
                        }), formitem.answeritems);
                  return newrecord;
                }), state.formitems);
          return newrecord$25;
      case /* ClearOption */19 :
          var index$9 = action[1];
          var rindex$3 = action[0];
          var newrecord$26 = Caml_obj.caml_obj_dup(state);
          newrecord$26.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$9 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.answeritems = $$Array.mapi((function (ri, answeritem) {
                          if (rindex$3 === ri) {
                            return {
                                    id: answeritem.id,
                                    value: answeritem.value,
                                    showAnswer: answeritem.showAnswer,
                                    ansrDelete: !answeritem.ansrDelete,
                                    ansrModify: answeritem.ansrModify,
                                    ansrCreate: answeritem.ansrCreate
                                  };
                          } else {
                            return answeritem;
                          }
                        }), formitem.answeritems);
                  return newrecord;
                }), state.formitems);
          return newrecord$26;
      case /* ShowType */20 :
          var index$10 = action[0];
          var newrecord$27 = Caml_obj.caml_obj_dup(state);
          newrecord$27.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$10 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showType = !formitem.showType;
                  return newrecord;
                }), state.formitems);
          return newrecord$27;
      case /* ClickType */21 :
          var index$11 = action[3];
          var operationitems = action[2];
          var operation = action[1];
          var type_ = action[0];
          var newrecord$28 = Caml_obj.caml_obj_dup(state);
          newrecord$28.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$11 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.operationitems = operationitems;
                  newrecord.operation = operation;
                  newrecord.showType = false;
                  newrecord.type_ = type_;
                  return newrecord;
                }), state.formitems);
          return newrecord$28;
      case /* ShowOperation */22 :
          var index$12 = action[0];
          var newrecord$29 = Caml_obj.caml_obj_dup(state);
          newrecord$29.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$12 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showOperation = !formitem.showOperation;
                  return newrecord;
                }), state.formitems);
          return newrecord$29;
      case /* ClickOperation */23 :
          var index$13 = action[1];
          var operation$1 = action[0];
          var newrecord$30 = Caml_obj.caml_obj_dup(state);
          newrecord$30.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$13 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.showOperation = false;
                  newrecord.operation = operation$1;
                  return newrecord;
                }), state.formitems);
          return newrecord$30;
      case /* ChangeArea */24 :
          var index$14 = action[1];
          var area = action[0];
          var newrecord$31 = Caml_obj.caml_obj_dup(state);
          newrecord$31.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$14 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.area = area;
                  return newrecord;
                }), state.formitems);
          return newrecord$31;
      case /* ChangeEror */25 :
          var index$15 = action[1];
          var eror = action[0];
          var newrecord$32 = Caml_obj.caml_obj_dup(state);
          newrecord$32.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$15 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.eror = eror;
                  return newrecord;
                }), state.formitems);
          return newrecord$32;
      case /* ClearCondition */26 :
          var index$16 = action[0];
          var newrecord$33 = Caml_obj.caml_obj_dup(state);
          newrecord$33.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$16 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showMore = false;
                  newrecord.showVeri = false;
                  return newrecord;
                }), state.formitems);
          return newrecord$33;
      case /* ShowMore */27 :
          var index$17 = action[0];
          var newrecord$34 = Caml_obj.caml_obj_dup(state);
          newrecord$34.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$17 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showMore = !formitem.showMore;
                  return newrecord;
                }), state.formitems);
          return newrecord$34;
      case /* ShowItemVerification */28 :
          var index$18 = action[4];
          var operationitems$1 = action[3];
          var operation$2 = action[2];
          var typeitems = action[1];
          var type_$1 = action[0];
          var newrecord$35 = Caml_obj.caml_obj_dup(state);
          newrecord$35.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$18 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formModify = true;
                  newrecord.showMore = false;
                  newrecord.operationitems = operationitems$1;
                  newrecord.operation = operation$2;
                  newrecord.typeitems = typeitems;
                  newrecord.type_ = type_$1;
                  newrecord.showVeri = true;
                  return newrecord;
                }), state.formitems);
          return newrecord$35;
      case /* CheckItem */29 :
          var index$19 = action[0];
          var newrecord$36 = Caml_obj.caml_obj_dup(state);
          newrecord$36.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$19 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.showCheck = !formitem.showCheck;
                  return newrecord;
                }), state.formitems);
          return newrecord$36;
      case /* DeleteItem */30 :
          var index$20 = action[0];
          var newrecord$37 = Caml_obj.caml_obj_dup(state);
          newrecord$37.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$20 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.formDelete = !formitem.formDelete;
                  return newrecord;
                }), state.formitems);
          return newrecord$37;
      case /* AddItem */31 :
          var index$21 = action[0];
          var newrecord$38 = Caml_obj.caml_obj_dup(state);
          newrecord$38.formitems = $$Array.mapi((function (i, formitem) {
                  if (index$21 !== i) {
                    return formitem;
                  }
                  var newrecord = Caml_obj.caml_obj_dup(formitem);
                  newrecord.answeritems = $$Array.append(formitem.answeritems, newansweritem(Caml_array.caml_array_get(Caml_array.caml_array_get(state.formitems, i).answeritems, formitem.answeritems.length - 1 | 0).id + 1 | 0));
                  return newrecord;
                }), state.formitems);
          return newrecord$38;
      case /* AddForm */32 :
          var newrecord$39 = Caml_obj.caml_obj_dup(state);
          newrecord$39.formitems = $$Array.append(state.formitems, newitem(Caml_array.caml_array_get(state.formitems, state.formitems.length - 1 | 0).iid + 1 | 0, action[0]));
          return newrecord$39;
      case /* DeleteForm */33 :
          var id = action[0];
          var newrecord$40 = Caml_obj.caml_obj_dup(state);
          newrecord$40.items = state.items.filter((function (item) {
                  return item.id !== id;
                }));
          return newrecord$40;
      case /* ChangeStdate */34 :
          var index$22 = action[1];
          var value$2 = action[0];
          var newrecord$41 = Caml_obj.caml_obj_dup(state);
          newrecord$41.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$22 === i) {
                    return {
                            stdate: value$2,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$41;
      case /* ChangeSttime */35 :
          var index$23 = action[1];
          var value$3 = action[0];
          var newrecord$42 = Caml_obj.caml_obj_dup(state);
          newrecord$42.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$23 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: value$3,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$42;
      case /* ChangeEndate */36 :
          var index$24 = action[1];
          var value$4 = action[0];
          var newrecord$43 = Caml_obj.caml_obj_dup(state);
          newrecord$43.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$24 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: value$4,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$43;
      case /* ChangeEntime */37 :
          var index$25 = action[1];
          var value$5 = action[0];
          var newrecord$44 = Caml_obj.caml_obj_dup(state);
          newrecord$44.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$25 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: value$5,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$44;
      case /* ShowExam */38 :
          var index$26 = action[0];
          var newrecord$45 = Caml_obj.caml_obj_dup(state);
          newrecord$45.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$26 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: !settitem.showExam,
                            randOption: settitem.showExam ? false : settitem.randOption,
                            randSubtile: settitem.showExam ? false : settitem.randSubtile,
                            showRestart: settitem.showExam ? false : settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$45;
      case /* RandOption */39 :
          var index$27 = action[0];
          var newrecord$46 = Caml_obj.caml_obj_dup(state);
          newrecord$46.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$27 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: !settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$46;
      case /* RandSubtile */40 :
          var index$28 = action[0];
          var newrecord$47 = Caml_obj.caml_obj_dup(state);
          newrecord$47.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$28 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: !settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$47;
      case /* ShowRestart */41 :
          var index$29 = action[0];
          var newrecord$48 = Caml_obj.caml_obj_dup(state);
          newrecord$48.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$29 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: !settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$48;
      case /* ChangeNumber */42 :
          var index$30 = action[1];
          var value$6 = action[0];
          var newrecord$49 = Caml_obj.caml_obj_dup(state);
          newrecord$49.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$30 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: value$6
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$49;
      case /* ShowLimit */43 :
          var index$31 = action[0];
          var newrecord$50 = Caml_obj.caml_obj_dup(state);
          newrecord$50.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$31 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: !settitem.showLimit,
                            dertitems: settitem.dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$50;
      case /* AddDert */44 :
          var dertitems = action[1];
          var index$32 = action[0];
          var newrecord$51 = Caml_obj.caml_obj_dup(state);
          newrecord$51.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$32 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: dertitems,
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$51;
      case /* ShowPanel */45 :
          var dindex = action[1];
          var index$33 = action[0];
          var newrecord$52 = Caml_obj.caml_obj_dup(state);
          newrecord$52.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$33 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: $$Array.mapi((function (di, dertitem) {
                                    if (dindex === di) {
                                      return {
                                              showPanel: !dertitem.showPanel,
                                              dertment: dertitem.dertment,
                                              operitems: dertitem.operitems,
                                              dertModify: dertitem.dertModify
                                            };
                                    } else {
                                      return dertitem;
                                    }
                                  }), settitem.dertitems),
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$52;
      case /* AddOper */46 :
          var operitems = action[2];
          var dindex$1 = action[1];
          var index$34 = action[0];
          var newrecord$53 = Caml_obj.caml_obj_dup(state);
          newrecord$53.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$34 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: $$Array.mapi((function (di, dertitem) {
                                    if (dindex$1 === di) {
                                      return {
                                              showPanel: dertitem.showPanel,
                                              dertment: dertitem.dertment,
                                              operitems: operitems,
                                              dertModify: dertitem.dertModify
                                            };
                                    } else {
                                      return dertitem;
                                    }
                                  }), settitem.dertitems),
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$53;
      case /* ShowOper */47 :
          var oindex = action[2];
          var dindex$2 = action[1];
          var index$35 = action[0];
          var newrecord$54 = Caml_obj.caml_obj_dup(state);
          newrecord$54.settitems = $$Array.mapi((function (i, settitem) {
                  if (index$35 === i) {
                    return {
                            stdate: settitem.stdate,
                            sttime: settitem.sttime,
                            endate: settitem.endate,
                            entime: settitem.entime,
                            showExam: settitem.showExam,
                            randOption: settitem.randOption,
                            randSubtile: settitem.randSubtile,
                            showRestart: settitem.showRestart,
                            showLimit: settitem.showLimit,
                            dertitems: $$Array.mapi((function (di, dertitem) {
                                    if (dindex$2 === di) {
                                      return {
                                              showPanel: dertitem.showPanel,
                                              dertment: dertitem.dertment,
                                              operitems: $$Array.mapi((function (oi, operitem) {
                                                      if (oindex === oi) {
                                                        return {
                                                                newid: operitem.newid,
                                                                userid: operitem.userid,
                                                                name: operitem.name,
                                                                showOper: !operitem.showOper
                                                              };
                                                      } else {
                                                        return operitem;
                                                      }
                                                    }), dertitem.operitems),
                                              dertModify: true
                                            };
                                    } else {
                                      return dertitem;
                                    }
                                  }), settitem.dertitems),
                            number: settitem.number
                          };
                  } else {
                    return settitem;
                  }
                }), state.settitems);
          return newrecord$54;
      case /* ActionSnackBar */48 :
          var newrecord$55 = Caml_obj.caml_obj_dup(state);
          newrecord$55.youtubeText = action[0];
          newrecord$55.showYoutube = action[1];
          return newrecord$55;
      
    }
  }
}

var initialState_tabitems = /* :: */[
  {
    showTabt: false,
    tabImage: Icons$BtsCore.descriptionBlack,
    tabPath: Path$BtsCore.proformPath
  },
  /* :: */[
    {
      showTabt: false,
      tabImage: Icons$BtsCore.tourBlack,
      tabPath: Path$BtsCore.protourPath
    },
    /* [] */0
  ]
];

var initialState_items = [];

var initialState_formtabitems = /* :: */[
  {
    showTab: true,
    tabImage: Icons$BtsCore.questionAnswerBlack
  },
  /* :: */[
    {
      showTab: false,
      tabImage: Icons$BtsCore.settingsBlack
    },
    /* :: */[
      {
        showTab: false,
        tabImage: Icons$BtsCore.personAddBlack
      },
      /* :: */[
        {
          showTab: false,
          tabImage: Icons$BtsCore.listBlack
        },
        /* [] */0
      ]
    ]
  ]
];

var initialState_formitems = [];

var initialState_settitems = [];

var initialState_viewitems = [];

var initialState = {
  formLoad: false,
  formWidth: 0,
  formHeight: 0,
  showProgress: true,
  error: false,
  insert: false,
  update: false,
  delete: false,
  export: false,
  tabitems: initialState_tabitems,
  index: 0,
  itemCount: 0,
  items: initialState_items,
  showRight: false,
  showDrop: false,
  showFile: false,
  showFull: false,
  formId: "",
  formTile: "",
  formDesc: "",
  formtabitems: initialState_formtabitems,
  formindex: 0,
  formitems: initialState_formitems,
  settitems: initialState_settitems,
  viewitems: initialState_viewitems,
  showYoutube: false,
  youtubeText: ""
};

function Proform(Props) {
  var match = React.useReducer(reducer, initialState);
  var dispatch = match[1];
  var state = match[0];
  var fileRef = React.useRef(null);
  var barShowRestoreAction = function (youtubeText) {
    Curry._1(dispatch, /* ActionSnackBar */Block.__(48, [
            youtubeText,
            true
          ]));
    setTimeout((function (param) {
            return Curry._1(dispatch, /* ActionSnackBar */Block.__(48, [
                          "",
                          false
                        ]));
          }), 5000);
    
  };
  var pollingFunc = function (length,count){ if (!state.showFull) { pollingAJax(length + count); } };
  var pollingEror = function (length){ if (!state.showFull) { setTimeout(() => pollingAJax(length), 15000); } };
  var pollingAJax = function (length) {
    Axiosapi$BtsCore.Proform.polling(Data$BtsCore.otherData(localStorage.getItem("newid"), length)).then((function (response) {
              return Promise.resolve((Curry._1(dispatch, /* SettingFormPolls */Block.__(2, [
                                  response.data.items.length,
                                  response.data.items
                                ])), pollingFunc(length, response.data.items.length)));
            })).catch((function (param) {
            return Promise.resolve(pollingEror(length));
          }));
    
  };
  var searchAJax = function (param) {
    Axiosapi$BtsCore.Proform.search(Data$BtsCore.userData(localStorage.getItem("newid"))).then((function (response) {
              var match = response.data.status;
              if (match === "istrue") {
                Curry._1(dispatch, /* SettingFormItems */Block.__(3, [
                        response.data.itemCount,
                        response.data.items
                      ]));
                Curry._1(dispatch, /* ActionShowProgress */2);
              } else {
                barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                Curry._1(dispatch, /* ActionShowProgress */2);
              }
              return Promise.resolve(pollingAJax(response.data.itemCount));
            })).catch((function (error) {
            return Promise.resolve((console.log(error), undefined));
          }));
    
  };
  var permissAJax = function (param) {
    Axiosapi$BtsCore.Form.permiss(Data$BtsCore.userData(localStorage.getItem("newid"))).then((function (response) {
              return Promise.resolve((Curry._1(dispatch, /* ActionPermissItems */Block.__(1, [
                                  response.data.insert,
                                  response.data.update,
                                  response.data.delete,
                                  response.data.export
                                ])), searchAJax(undefined)));
            })).catch((function (error) {
            return Promise.resolve((console.log(error), undefined));
          }));
    
  };
  React.useEffect((function () {
          var match = state.formLoad;
          if (match) {
            return (function (param) {
                      console.log("action");
                      
                    });
          }
          Curry._1(dispatch, /* SettingFormLoad */1);
          Curry._1(dispatch, /* SettingFormWidth */Block.__(0, [
                  window.innerWidth,
                  window.innerHeight
                ]));
          var timeId = permissAJax(undefined);
          return (function (param) {
                    return timeId;
                  });
        }));
  var handleResize = function ($$event) {
    return Curry._1(dispatch, /* SettingFormWidth */Block.__(0, [
                  $$event.currentTarget.innerWidth,
                  $$event.currentTarget.innerHeight
                ]));
  };
  React.useEffect((function () {
          window.addEventListener("resize", handleResize, true);
          return (function (param) {
                    
                  });
        }), ([]));
  var clickItemTab = React.useCallback((function (i) {
          return (function (tabPath) {
              Curry._1(dispatch, /* ClickItemTab */Block.__(5, [i]));
              return ReasonReactRouter.push(tabPath);
            });
        }));
  var showAnimationRight = React.useCallback((function (param) {
          return Curry._1(dispatch, /* ShowAnimationRight */3);
        }));
  var settAJax = function (id) {
    Axiosapi$BtsCore.Proform.sett(Data$BtsCore.dFormData(id, localStorage.getItem("newid"))).then((function (response) {
              var match = response.data.status;
              var tmp;
              if (match === "istrue") {
                barShowRestoreAction(Status$BtsCore.uploadModels("success"));
                tmp = Curry._1(dispatch, /* ActionShowProgress */2);
              } else {
                barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                tmp = Curry._1(dispatch, /* ActionShowProgress */2);
              }
              return Promise.resolve(tmp);
            })).catch((function (error) {
            return Promise.resolve((console.log(error), undefined));
          }));
    
  };
  var uploadAJax = function (files) {
    var formData = new FormData();
    formData.append("file", files);
    Axiosapi$BtsCore.Excels.upload(formData).then((function (response) {
              var match = response.data.status;
              var tmp;
              if (match === "istrue") {
                tmp = settAJax(response.data.formId);
              } else {
                barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                tmp = Curry._1(dispatch, /* ActionShowProgress */2);
              }
              return Promise.resolve(tmp);
            })).catch((function (error) {
            return Promise.resolve((console.log(error), undefined));
          }));
    
  };
  var dragOver = React.useCallback((function ($$event) {
          $$event.preventDefault();
          $$event.stopPropagation();
          return Curry._1(dispatch, /* ShowDrop */Block.__(6, [true]));
        }));
  var dragLeave = React.useCallback((function ($$event) {
          $$event.preventDefault();
          $$event.stopPropagation();
          return Curry._1(dispatch, /* ShowDrop */Block.__(6, [false]));
        }));
  var dropFile = React.useCallback((function ($$event) {
          return (function (value) {
              $$event.preventDefault();
              $$event.stopPropagation();
              Curry._1(dispatch, /* ActionShowProgress */2);
              Curry._1(dispatch, /* ShowDrop */Block.__(6, [false]));
              return uploadAJax(value);
            });
        }));
  var uploadFile = React.useCallback((function (value) {
          Curry._1(dispatch, /* ActionShowProgress */2);
          return uploadAJax(value);
        }));
  var chooseFile = React.useCallback((function (param) {
          var el = fileRef.current;
          if (!(el == null)) {
            el.click();
            return ;
          }
          
        }));
  var closeAnimationRight = React.useCallback((function (param) {
          return Curry._1(dispatch, /* CloseAnimationRight */5);
        }));
  var clickFormBoard = React.useCallback((function (id) {
          Curry._1(dispatch, /* ActionShowProgress */2);
          Axiosapi$BtsCore.Proform.sItem(Data$BtsCore.dFormData(id, localStorage.getItem("newid"))).then((function (response) {
                    var match = response.data.status;
                    var tmp;
                    if (match === "istrue") {
                      Curry._1(dispatch, /* ShowAnimationFull */Block.__(7, [
                              response.data.formId,
                              response.data.tile,
                              response.data.desc,
                              response.data.items,
                              response.data.settitems
                            ]));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    } else {
                      barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    }
                    return Promise.resolve(tmp);
                  })).catch((function (error) {
                  return Promise.resolve((console.log(error), undefined));
                }));
          
        }));
  var changeFormTile = React.useCallback((function (value) {
          return Curry._1(dispatch, /* ChangeFormTile */Block.__(9, [value]));
        }));
  React.useCallback((function (value) {
          return Curry._1(dispatch, /* ChangeFormDesc */Block.__(10, [value]));
        }));
  var sLimitAJax = function (i) {
    Axiosapi$BtsCore.Proform.sLimit(Data$BtsCore.dFormData(state.formId, localStorage.getItem("newid"))).then((function (response) {
              return Promise.resolve((Curry._1(dispatch, /* AddDert */Block.__(44, [
                                  i,
                                  response.data.items
                                ])), Curry._1(dispatch, /* ActionShowProgress */2)));
            })).catch((function (error) {
            return Promise.resolve((console.log(error), undefined));
          }));
    
  };
  var clickFormTab = React.useCallback((function (i) {
          Curry._1(dispatch, /* ClickFormTab */Block.__(11, [i]));
          if (i === 2 && Caml_array.caml_array_get(state.settitems, 0).showLimit) {
            Curry._1(dispatch, /* ActionShowProgress */2);
            return sLimitAJax(0);
          } else if (i === 3) {
            Curry._1(dispatch, /* ActionShowProgress */2);
            Axiosapi$BtsCore.Proform.sWrite(Data$BtsCore.dFormData(state.formId, localStorage.getItem("newid"))).then((function (response) {
                      return Promise.resolve((Curry._1(dispatch, /* SettingViewItems */Block.__(8, [response.data.items])), Curry._1(dispatch, /* ActionShowProgress */2)));
                    })).catch((function (error) {
                    return Promise.resolve((console.log(error), undefined));
                  }));
            return ;
          } else {
            return ;
          }
        }));
  var clickBoardPaper = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ClickBoardPaper */Block.__(12, [i]));
        }));
  var changeTile = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeTile */Block.__(13, [
                            value,
                            i
                          ]));
            });
        }));
  var showOut = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowOut */Block.__(14, [i]));
        }));
  var showValue = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ShowValue */Block.__(15, [
                            value,
                            i
                          ]));
            });
        }));
  var changeText = React.useCallback((function (value) {
          return (function (ri, i) {
              return Curry._1(dispatch, /* ChangeText */Block.__(16, [
                            value,
                            ri,
                            i
                          ]));
            });
        }));
  var clickElement = React.useCallback((function (value) {
          return (function (ri, i) {
              if (value === "checkbox") {
                return Curry._1(dispatch, /* ClickCheckbox */Block.__(18, [
                              ri,
                              i
                            ]));
              } else {
                return Curry._1(dispatch, /* ClickRadio */Block.__(17, [
                              ri,
                              i
                            ]));
              }
            });
        }));
  var clearOption = React.useCallback((function (ri) {
          return (function (i) {
              return Curry._1(dispatch, /* ClearOption */Block.__(19, [
                            ri,
                            i
                          ]));
            });
        }));
  var showType = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowType */Block.__(20, [i]));
        }));
  var clickType = React.useCallback((function (type_) {
          return (function (i) {
              Axiosapi$BtsCore.Proform.sType(Data$BtsCore.sRowsData(state.formId, i, localStorage.getItem("newid"))).then((function (response) {
                        var match = response.data.status;
                        var tmp;
                        if (match === "istrue") {
                          tmp = Curry._1(dispatch, /* ClickType */Block.__(21, [
                                  i,
                                  response.data.value,
                                  response.data.items,
                                  type_
                                ]));
                        } else {
                          barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                          tmp = Curry._1(dispatch, /* ClearCondition */Block.__(26, [type_]));
                        }
                        return Promise.resolve(tmp);
                      })).catch((function (error) {
                      return Promise.resolve((console.log(error), undefined));
                    }));
              
            });
        }));
  var showOperation = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowOperation */Block.__(22, [i]));
        }));
  var clickOperation = React.useCallback((function (operation) {
          return (function (i) {
              return Curry._1(dispatch, /* ClickOperation */Block.__(23, [
                            operation,
                            i
                          ]));
            });
        }));
  var changeArea = React.useCallback((function (area) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeArea */Block.__(24, [
                            area,
                            i
                          ]));
            });
        }));
  var changeEror = React.useCallback((function (area) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeEror */Block.__(25, [
                            area,
                            i
                          ]));
            });
        }));
  var clearCondition = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ClearCondition */Block.__(26, [i]));
        }));
  var showMore = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowMore */Block.__(27, [i]));
        }));
  var showVerification = React.useCallback((function (id) {
          return (function (showVeri, i) {
              if (showVeri) {
                return Curry._1(dispatch, /* ClearCondition */Block.__(26, [i]));
              } else {
                Axiosapi$BtsCore.Proform.sVeri(Data$BtsCore.sRowsData(state.formId, i, localStorage.getItem("newid"))).then((function (response) {
                          var match = response.data.status;
                          var tmp;
                          if (match === "istrue") {
                            tmp = Curry._1(dispatch, /* ShowItemVerification */Block.__(28, [
                                    response.data.type_,
                                    response.data.typeitems,
                                    response.data.operation,
                                    response.data.operationitems,
                                    id
                                  ]));
                          } else {
                            barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                            tmp = Curry._1(dispatch, /* ClearCondition */Block.__(26, [id]));
                          }
                          return Promise.resolve(tmp);
                        })).catch((function (error) {
                        return Promise.resolve((console.log(error), undefined));
                      }));
                return ;
              }
            });
        }));
  var checkItem = React.useCallback((function (i) {
          return Curry._1(dispatch, /* CheckItem */Block.__(29, [i]));
        }));
  var deleteItem = React.useCallback((function (i) {
          return Curry._1(dispatch, /* DeleteItem */Block.__(30, [i]));
        }));
  var addItem = React.useCallback((function (i) {
          return Curry._1(dispatch, /* AddItem */Block.__(31, [i]));
        }));
  var insertForm = React.useCallback((function (param) {
          Curry._1(dispatch, /* ActionShowProgress */2);
          Axiosapi$BtsCore.Proform.insert(Data$BtsCore.uFormsData(state.formId, state.formTile, state.formDesc, state.formitems.filter((function (formitem) {
                              if (formitem.formDelete === true || formitem.formModify === true) {
                                return true;
                              } else {
                                return formitem.formCreate === true;
                              }
                            })), state.settitems, Caml_array.caml_array_get(state.settitems, 0).dertitems.filter((function (dertitem) {
                              return dertitem.dertModify === true;
                            })), localStorage.getItem("newid"))).then((function (response) {
                    var match = response.data.status;
                    var tmp;
                    if (match === "istrue") {
                      Curry._1(dispatch, /* CloseAnimationFull */6);
                      barShowRestoreAction(Status$BtsCore.statusModule("saveSuccess"));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    } else {
                      barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    }
                    return Promise.resolve(tmp);
                  })).catch((function (error) {
                  return Promise.resolve((console.log(error), undefined));
                }));
          
        }));
  var addForm = React.useCallback((function (param) {
          Curry._1(dispatch, /* ActionShowProgress */2);
          Axiosapi$BtsCore.Proform.add(Data$BtsCore.userData(localStorage.getItem("newid"))).then((function (response) {
                    return Promise.resolve((Curry._1(dispatch, /* AddForm */Block.__(32, [response.data.items])), Curry._1(dispatch, /* ActionShowProgress */2)));
                  })).catch((function (error) {
                  return Promise.resolve((console.log(error), undefined));
                }));
          
        }));
  var deleteForm = React.useCallback((function (param) {
          Curry._1(dispatch, /* ActionShowProgress */2);
          Axiosapi$BtsCore.Proform.$$delete(Data$BtsCore.dFormData(state.formId, localStorage.getItem("newid"))).then((function (response) {
                    var match = response.data.status;
                    var tmp;
                    if (match === "istrue") {
                      Curry._1(dispatch, /* DeleteForm */Block.__(33, [state.formId]));
                      Curry._1(dispatch, /* CloseAnimationFull */6);
                      barShowRestoreAction(Status$BtsCore.statusModule("deleteSuccess"));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    } else {
                      barShowRestoreAction(Status$BtsCore.statusModule(response.data.status));
                      tmp = Curry._1(dispatch, /* ActionShowProgress */2);
                    }
                    return Promise.resolve(tmp);
                  })).catch((function (error) {
                  return Promise.resolve((console.log(error), undefined));
                }));
          
        }));
  var changeStdate = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeStdate */Block.__(34, [
                            value,
                            i
                          ]));
            });
        }));
  var changeSttime = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeSttime */Block.__(35, [
                            value,
                            i
                          ]));
            });
        }));
  var changeEndate = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeEndate */Block.__(36, [
                            value,
                            i
                          ]));
            });
        }));
  var changeEntime = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeEntime */Block.__(37, [
                            value,
                            i
                          ]));
            });
        }));
  var showExam = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowExam */Block.__(38, [i]));
        }));
  var randOption = React.useCallback((function (i) {
          return Curry._1(dispatch, /* RandOption */Block.__(39, [i]));
        }));
  var randSubtile = React.useCallback((function (i) {
          return Curry._1(dispatch, /* RandSubtile */Block.__(40, [i]));
        }));
  var showRestart = React.useCallback((function (i) {
          return Curry._1(dispatch, /* ShowRestart */Block.__(41, [i]));
        }));
  var changeNumber = React.useCallback((function (value) {
          return (function (i) {
              return Curry._1(dispatch, /* ChangeNumber */Block.__(42, [
                            value,
                            i
                          ]));
            });
        }));
  var showLimit = React.useCallback((function (value) {
          return (function (i) {
              Curry._1(dispatch, /* ShowLimit */Block.__(43, [i]));
              if (!value) {
                Curry._1(dispatch, /* ActionShowProgress */2);
                return sLimitAJax(i);
              }
              
            });
        }));
  var showPanel = React.useCallback((function (value) {
          return (function (i, di, items) {
              Curry._1(dispatch, /* ShowPanel */Block.__(45, [
                      i,
                      di
                    ]));
              if (items.length === 0) {
                Axiosapi$BtsCore.Proform.sOper(Data$BtsCore.sRowsData(state.formId, value, localStorage.getItem("newid"))).then((function (response) {
                          return Promise.resolve(Curry._1(dispatch, /* AddOper */Block.__(46, [
                                            i,
                                            di,
                                            response.data.items
                                          ])));
                        })).catch((function (error) {
                        return Promise.resolve((console.log(error), undefined));
                      }));
                return ;
              }
              
            });
        }));
  var showOper = React.useCallback((function (i) {
          return (function (di, oi) {
              return Curry._1(dispatch, /* ShowOper */Block.__(47, [
                            i,
                            di,
                            oi
                          ]));
            });
        }));
  var closeAnimationFull = React.useCallback((function (param) {
          return Curry._1(dispatch, /* CloseAnimationFull */6);
        }));
  var match$1 = state.formindex;
  var tmp;
  switch (match$1) {
    case 0 :
        tmp = $$Array.mapi((function (i, formitem) {
                var match = formitem.outValue;
                var tmp;
                switch (match) {
                  case "droplist" :
                      tmp = React.createElement(GridContainer$BtsCore.make, {
                            direction: "column",
                            justify: "center",
                            alignItem: "stretch",
                            children: $$Array.mapi((function (ai, answeritem) {
                                    return React.createElement(GridItem$BtsCore.make, {
                                                top: "0",
                                                right: "0",
                                                bottom: "6",
                                                left: "0",
                                                xs: "auto",
                                                children: React.createElement(GridContainer$BtsCore.make, {
                                                      direction: "row",
                                                      justify: "start",
                                                      alignItem: "center",
                                                      children: null
                                                    }, React.createElement(GridItem$BtsCore.make, {
                                                          top: "0",
                                                          right: "0",
                                                          bottom: "0",
                                                          left: "0",
                                                          xs: "no",
                                                          children: React.createElement(IconButton$BtsCore.make, {
                                                                padding: "4",
                                                                disabled: state.showProgress,
                                                                children: React.createElement(IconAction$BtsCore.make, {
                                                                      animation: "leftRight",
                                                                      src: Icons$BtsCore.radioButtonUncheckedBlack
                                                                    })
                                                              })
                                                        }), React.createElement(GridItem$BtsCore.make, {
                                                          top: "0",
                                                          right: "6",
                                                          bottom: "0",
                                                          left: "0",
                                                          xs: "auto",
                                                          children: React.createElement(TextFieldStandard$BtsCore.make, {
                                                                top: "0",
                                                                enterBorderColor: AnswerColor$BtsCore.enterBorder(answeritem.showAnswer),
                                                                downBorderColor: AnswerColor$BtsCore.downBorder(answeritem.showAnswer),
                                                                borderColor: AnswerColor$BtsCore.border(answeritem.showAnswer),
                                                                placeholder: "Option",
                                                                value: answeritem.value,
                                                                disabled: state.showProgress || formitem.formDelete,
                                                                onChange: (function ($$event) {
                                                                    return Curry._3(changeText, $$event.target.value, ai, i);
                                                                  }),
                                                                children: null
                                                              })
                                                        }), formitem.showLine ? React.createElement(GridItem$BtsCore.make, {
                                                            top: "0",
                                                            right: "0",
                                                            bottom: "0",
                                                            left: "0",
                                                            xs: "no",
                                                            children: React.createElement(IconButton$BtsCore.make, {
                                                                  padding: "4",
                                                                  disabled: state.showProgress || formitem.formDelete,
                                                                  onClick: (function (param) {
                                                                      return Curry._2(clearOption, ai, i);
                                                                    }),
                                                                  children: React.createElement(IconAction$BtsCore.make, {
                                                                        animation: "circle",
                                                                        src: answeritem.ansrDelete ? Icons$BtsCore.refreshBlack : Icons$BtsCore.clearWarn
                                                                      })
                                                                })
                                                          }) : null)
                                              });
                                  }), formitem.answeritems)
                          });
                      break;
                  case "image" :
                      tmp = React.createElement(ImageUpload$BtsCore.make, {
                            webLoad: state.showProgress,
                            showDrop: formitem.showDrop,
                            showFile: formitem.showFile,
                            disabled: true
                          });
                      break;
                  case "label" :
                      tmp = React.createElement(Typography$BtsCore.make, {
                            variant: "subtitle2",
                            style: {
                              paddingRight: "6px",
                              paddingLeft: "6px"
                            },
                            noWrap: true,
                            children: null
                          });
                      break;
                  case "text" :
                      tmp = React.createElement(TextFieldStandard$BtsCore.make, {
                            width: "50",
                            top: "0",
                            left: "0",
                            enterBorderColor: "rgba(255,0,0,0.8)",
                            downBorderColor: "rgba(255,0,0,0.6)",
                            borderColor: "rgba(0,0,0,0.2)",
                            disabled: true,
                            children: null
                          });
                      break;
                  case "textarea" :
                      tmp = React.createElement(TextFieldStandard$BtsCore.make, {
                            top: "0",
                            left: "0",
                            enterBorderColor: "rgba(255,0,0,0.8)",
                            downBorderColor: "rgba(255,0,0,0.6)",
                            borderColor: "rgba(0,0,0,0.2)",
                            disabled: true,
                            children: null
                          });
                      break;
                  case "textline" :
                      tmp = React.createElement(TextFieldMultiline$BtsCore.make, {
                            top: "12",
                            bottom: "12",
                            left: "0",
                            labelColor: "rgba(255,0,0,0.8)",
                            borderTop: "10",
                            borderBottom: "10",
                            enterBorderColor: "rgba(255,0,0,0.8)",
                            downBorderColor: "rgba(255,0,0,0.6)",
                            borderColor: "rgba(0,0,0,0.2)",
                            rows: 3,
                            disabled: true,
                            children: null
                          });
                      break;
                  default:
                    tmp = React.createElement(GridContainer$BtsCore.make, {
                          direction: "column",
                          justify: "center",
                          alignItem: "stretch",
                          children: $$Array.mapi((function (ai, answeritem) {
                                  return React.createElement(GridItem$BtsCore.make, {
                                              top: "0",
                                              right: "0",
                                              bottom: "6",
                                              left: "0",
                                              xs: "auto",
                                              children: React.createElement(GridContainer$BtsCore.make, {
                                                    direction: "row",
                                                    justify: "start",
                                                    alignItem: "center",
                                                    children: null
                                                  }, React.createElement(GridItem$BtsCore.make, {
                                                        top: "0",
                                                        right: "0",
                                                        bottom: "0",
                                                        left: "0",
                                                        xs: "no",
                                                        children: React.createElement(IconButton$BtsCore.make, {
                                                              padding: "4",
                                                              disabled: state.showProgress,
                                                              children: React.createElement(IconAction$BtsCore.make, {
                                                                    animation: "leftRight",
                                                                    src: IconAnimation$BtsCore.answerIcon(formitem.outValue, false)
                                                                  })
                                                            })
                                                      }), React.createElement(GridItem$BtsCore.make, {
                                                        top: "0",
                                                        right: "6",
                                                        bottom: "0",
                                                        left: "0",
                                                        xs: "auto",
                                                        children: React.createElement(TextFieldStandard$BtsCore.make, {
                                                              top: "0",
                                                              enterBorderColor: AnswerColor$BtsCore.enterBorder(answeritem.showAnswer),
                                                              downBorderColor: AnswerColor$BtsCore.downBorder(answeritem.showAnswer),
                                                              borderColor: AnswerColor$BtsCore.border(answeritem.showAnswer),
                                                              placeholder: "Option",
                                                              value: answeritem.value,
                                                              disabled: state.showProgress || formitem.formDelete,
                                                              onChange: (function ($$event) {
                                                                  return Curry._3(changeText, $$event.target.value, ai, i);
                                                                }),
                                                              children: null
                                                            })
                                                      }), formitem.showLine ? React.createElement(React.Fragment, undefined, React.createElement(GridItem$BtsCore.make, {
                                                              top: "0",
                                                              right: "6",
                                                              bottom: "0",
                                                              left: "0",
                                                              xs: "no",
                                                              children: React.createElement(IconButton$BtsCore.make, {
                                                                    padding: "4",
                                                                    disabled: state.showProgress || formitem.formDelete,
                                                                    onClick: (function (param) {
                                                                        return Curry._3(clickElement, formitem.outValue, ai, i);
                                                                      }),
                                                                    children: React.createElement(IconAction$BtsCore.make, {
                                                                          animation: "leftRight",
                                                                          src: answeritem.showAnswer ? Icons$BtsCore.doneSuccessful : Icons$BtsCore.errorWarn
                                                                        })
                                                                  })
                                                            }), React.createElement(GridItem$BtsCore.make, {
                                                              top: "0",
                                                              right: "0",
                                                              bottom: "0",
                                                              left: "0",
                                                              xs: "no",
                                                              children: React.createElement(IconButton$BtsCore.make, {
                                                                    padding: "4",
                                                                    disabled: state.showProgress || formitem.formDelete,
                                                                    onClick: (function (param) {
                                                                        return Curry._2(clearOption, ai, i);
                                                                      }),
                                                                    children: React.createElement(IconAction$BtsCore.make, {
                                                                          animation: "circle",
                                                                          src: answeritem.ansrDelete ? Icons$BtsCore.refreshBlack : Icons$BtsCore.clearWarn
                                                                        })
                                                                  })
                                                            })) : null)
                                            });
                                }), formitem.answeritems)
                        });
                }
                var tmp$1;
                if (formitem.showLine) {
                  var tmp$2;
                  if (formitem.showMore && !formitem.formDelete) {
                    var match$1 = formitem.outValue;
                    var tmp$3;
                    switch (match$1) {
                      case "checkbox" :
                          tmp$3 = React.createElement(MenuIcon$BtsCore.make, {
                                top: "0",
                                right: "8",
                                bottom: "0",
                                left: "8",
                                disablePadding: true,
                                topLeft: "12",
                                topRight: "12",
                                bottomRight: "12",
                                bottomLeft: "12",
                                children: /* tuple */[
                                  React.createElement(IconGeneral$BtsCore.make, {
                                        src: Icons$BtsCore.doneSuccessful
                                      }),
                                  React.createElement(ReactIntl.FormattedMessage, {
                                        id: "desc",
                                        defaultMessage: "Desc"
                                      })
                                ]
                              });
                          break;
                      case "radio" :
                          tmp$3 = React.createElement(React.Fragment, undefined, React.createElement(MenuIcon$BtsCore.make, {
                                    top: "0",
                                    right: "8",
                                    bottom: "0",
                                    left: "8",
                                    disablePadding: true,
                                    topLeft: "12",
                                    topRight: "12",
                                    bottomRight: "12",
                                    bottomLeft: "12",
                                    children: /* tuple */[
                                      React.createElement(IconGeneral$BtsCore.make, {
                                            src: Icons$BtsCore.doneSuccessful
                                          }),
                                      React.createElement(ReactIntl.FormattedMessage, {
                                            id: "desc",
                                            defaultMessage: "Desc"
                                          })
                                    ]
                                  }), React.createElement(MenuIcon$BtsCore.make, {
                                    top: "0",
                                    right: "8",
                                    bottom: "0",
                                    left: "8",
                                    disablePadding: true,
                                    topLeft: "12",
                                    topRight: "12",
                                    bottomRight: "12",
                                    bottomLeft: "12",
                                    children: /* tuple */[
                                      React.createElement(IconGeneral$BtsCore.make, {
                                            src: Icons$BtsCore.doneSuccessful
                                          }),
                                      React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Default.relevant",
                                            defaultMessage: "Relevant"
                                          })
                                    ]
                                  }));
                          break;
                      default:
                        tmp$3 = React.createElement(React.Fragment, undefined, React.createElement(MenuIcon$BtsCore.make, {
                                  top: "0",
                                  right: "8",
                                  bottom: "0",
                                  left: "8",
                                  disablePadding: true,
                                  topLeft: "12",
                                  topRight: "12",
                                  bottomRight: "12",
                                  bottomLeft: "12",
                                  children: /* tuple */[
                                    React.createElement(IconGeneral$BtsCore.make, {
                                          src: Icons$BtsCore.doneSuccessful
                                        }),
                                    React.createElement(ReactIntl.FormattedMessage, {
                                          id: "desc",
                                          defaultMessage: "Desc"
                                        })
                                  ]
                                }), React.createElement(MenuIcon$BtsCore.make, {
                                  top: "0",
                                  right: "8",
                                  bottom: "0",
                                  left: "8",
                                  disablePadding: true,
                                  topLeft: "12",
                                  topRight: "12",
                                  bottomRight: "12",
                                  bottomLeft: "12",
                                  onClick: (function (param) {
                                      return Curry._3(showVerification, formitem.iid, formitem.showVeri, i);
                                    }),
                                  children: /* tuple */[
                                    React.createElement(IconGeneral$BtsCore.make, {
                                          src: Icons$BtsCore.doneSuccessful
                                        }),
                                    React.createElement(ReactIntl.FormattedMessage, {
                                          id: "Default.verification",
                                          defaultMessage: "Verification"
                                        })
                                  ]
                                }));
                    }
                    tmp$2 = React.createElement(SelectMenu$BtsCore.make, {
                          top: "100%",
                          right: "0",
                          transform: "translate(0, -100%)",
                          maxWidth: "256",
                          width: "256",
                          maxHeight: "280",
                          minHeight: "0",
                          topLeft: "12",
                          topRight: "12",
                          bottomRight: "12",
                          bottomLeft: "12",
                          paddingRight: "8",
                          paddingLeft: "8",
                          children: tmp$3
                        });
                  } else {
                    tmp$2 = null;
                  }
                  var match$2 = formitem.outValue;
                  var tmp$4;
                  var exit = 0;
                  switch (match$2) {
                    case "checkbox" :
                    case "droplist" :
                    case "radio" :
                        exit = 1;
                        break;
                    default:
                      tmp$4 = null;
                  }
                  if (exit === 1) {
                    tmp$4 = React.createElement(GridItem$BtsCore.make, {
                          top: "0",
                          right: "0",
                          bottom: "0",
                          left: "0",
                          xs: "no",
                          children: React.createElement(IconButton$BtsCore.make, {
                                padding: "8",
                                disabled: state.showProgress || formitem.formDelete,
                                onClick: (function (param) {
                                    return Curry._1(addItem, i);
                                  }),
                                children: null
                              }, React.createElement(Tooltip$BtsCore.make, {
                                    location: "top",
                                    backgroundColor: "rgba(255,0,0,0.8)",
                                    children: React.createElement(ReactIntl.FormattedMessage, {
                                          id: "add",
                                          defaultMessage: "Add"
                                        })
                                  }), React.createElement(IconAction$BtsCore.make, {
                                    animation: "circle",
                                    src: Icons$BtsCore.addBlack
                                  }))
                        });
                  }
                  tmp$1 = React.createElement(React.Fragment, undefined, formitem.showVeri ? React.createElement(GridItem$BtsCore.make, {
                              top: "0",
                              bottom: "0",
                              xs: "auto",
                              children: React.createElement(GridContainer$BtsCore.make, {
                                    direction: "row",
                                    justify: "start",
                                    alignItem: "center",
                                    children: null
                                  }, React.createElement(GridItem$BtsCore.make, {
                                        top: "0",
                                        right: "0",
                                        bottom: "0",
                                        left: "0",
                                        xs: "auto",
                                        children: null
                                      }, React.createElement(SelectStandard$BtsCore.make, {
                                            top: "0",
                                            bottom: "0",
                                            enterBorderColor: "transparent",
                                            downBorderColor: "transparent",
                                            borderColor: "transparent",
                                            value: formitem.type_,
                                            disabled: state.showProgress || formitem.formDelete,
                                            onClick: (function (param) {
                                                return Curry._1(showType, i);
                                              }),
                                            children: /* tuple */[
                                              formitem.showType && !formitem.formDelete ? React.createElement(SelectMenu$BtsCore.make, {
                                                      top: "50%",
                                                      transform: "translate(0, -50%)",
                                                      maxHeight: "280",
                                                      minHeight: "0",
                                                      topLeft: "12",
                                                      topRight: "12",
                                                      bottomRight: "12",
                                                      bottomLeft: "12",
                                                      paddingRight: "8",
                                                      paddingLeft: "8",
                                                      children: $$Array.map((function (typeitem) {
                                                              return React.createElement(MenuItem$BtsCore.make, {
                                                                          top: "0",
                                                                          right: "8",
                                                                          bottom: "0",
                                                                          left: "8",
                                                                          disablePadding: typeitem.optionPadding,
                                                                          topLeft: "12",
                                                                          topRight: "12",
                                                                          bottomRight: "12",
                                                                          bottomLeft: "12",
                                                                          onClick: (function (param) {
                                                                              return Curry._2(clickType, i, typeitem.value);
                                                                            }),
                                                                          children: typeitem.value
                                                                        });
                                                            }), formitem.typeitems)
                                                    }) : null,
                                              React.createElement(IconGeneral$BtsCore.make, {
                                                    animation: IconAnimation$BtsCore.topDownRorate(formitem.showType),
                                                    src: Icons$BtsCore.arrowDownBlack
                                                  })
                                            ]
                                          }), React.createElement(BackgroundBoard$BtsCore.make, {
                                            showBackground: formitem.showType,
                                            backgroundColor: "transparent",
                                            onClick: (function (param) {
                                                return Curry._1(showType, i);
                                              })
                                          })), React.createElement(GridItem$BtsCore.make, {
                                        top: "0",
                                        right: "0",
                                        bottom: "0",
                                        left: "0",
                                        xs: "auto",
                                        children: null
                                      }, React.createElement(SelectStandard$BtsCore.make, {
                                            top: "0",
                                            bottom: "0",
                                            enterBorderColor: "transparent",
                                            downBorderColor: "transparent",
                                            borderColor: "transparent",
                                            value: formitem.operation,
                                            disabled: state.showProgress || formitem.formDelete,
                                            onClick: (function (param) {
                                                return Curry._1(showOperation, i);
                                              }),
                                            children: /* tuple */[
                                              formitem.showOperation && !formitem.formDelete ? React.createElement(SelectMenu$BtsCore.make, {
                                                      top: "50%",
                                                      transform: "translate(0, -50%)",
                                                      maxHeight: "280",
                                                      minHeight: "0",
                                                      topLeft: "12",
                                                      topRight: "12",
                                                      bottomRight: "12",
                                                      bottomLeft: "12",
                                                      paddingRight: "8",
                                                      paddingLeft: "8",
                                                      children: $$Array.map((function (operationitem) {
                                                              return React.createElement(MenuItem$BtsCore.make, {
                                                                          top: "0",
                                                                          right: "8",
                                                                          bottom: "0",
                                                                          left: "8",
                                                                          disablePadding: operationitem.optionPadding,
                                                                          topLeft: "12",
                                                                          topRight: "12",
                                                                          bottomRight: "12",
                                                                          bottomLeft: "12",
                                                                          onClick: (function (param) {
                                                                              return Curry._2(clickOperation, operationitem.value, i);
                                                                            }),
                                                                          children: operationitem.value
                                                                        });
                                                            }), formitem.operationitems)
                                                    }) : null,
                                              React.createElement(IconGeneral$BtsCore.make, {
                                                    animation: IconAnimation$BtsCore.topDownRorate(formitem.showOperation),
                                                    src: Icons$BtsCore.arrowDownBlack
                                                  })
                                            ]
                                          }), React.createElement(BackgroundBoard$BtsCore.make, {
                                            showBackground: formitem.showOperation,
                                            backgroundColor: "transparent",
                                            onClick: (function (param) {
                                                return Curry._1(showOperation, i);
                                              })
                                          })), React.createElement(GridItem$BtsCore.make, {
                                        top: "0",
                                        right: "0",
                                        bottom: "0",
                                        left: "0",
                                        xs: "auto",
                                        children: React.createElement(TextFieldStandard$BtsCore.make, {
                                              top: "0",
                                              right: "0",
                                              bottom: "0",
                                              left: "0",
                                              value: formitem.area,
                                              disabled: state.showProgress || formitem.formDelete,
                                              onChange: (function ($$event) {
                                                  return Curry._2(changeArea, $$event.target.value, i);
                                                }),
                                              children: null
                                            })
                                      }), React.createElement(GridItem$BtsCore.make, {
                                        top: "0",
                                        right: "0",
                                        bottom: "0",
                                        left: "0",
                                        xs: "auto",
                                        children: React.createElement(TextFieldStandard$BtsCore.make, {
                                              top: "0",
                                              right: "0",
                                              bottom: "0",
                                              left: "0",
                                              value: formitem.eror,
                                              disabled: state.showProgress || formitem.formDelete,
                                              onChange: (function ($$event) {
                                                  return Curry._2(changeEror, $$event.target.value, i);
                                                }),
                                              children: null
                                            })
                                      }), React.createElement(GridItem$BtsCore.make, {
                                        top: "0",
                                        right: "0",
                                        bottom: "0",
                                        left: "0",
                                        xs: "no",
                                        children: React.createElement(IconButton$BtsCore.make, {
                                              padding: "8",
                                              disabled: state.showProgress || formitem.formDelete,
                                              onClick: (function (param) {
                                                  return Curry._1(clearCondition, i);
                                                }),
                                              children: React.createElement(IconAction$BtsCore.make, {
                                                    animation: "circle",
                                                    src: Icons$BtsCore.clearBlack
                                                  })
                                            })
                                      }))
                            }) : null, React.createElement(GridItem$BtsCore.make, {
                            xs: "auto",
                            children: React.createElement(Divider$BtsCore.make, { })
                          }), React.createElement(GridItem$BtsCore.make, {
                            top: "0",
                            right: "0",
                            bottom: "0",
                            left: "0",
                            xs: "auto",
                            children: React.createElement(GridContainer$BtsCore.make, {
                                  direction: "rowReverse",
                                  justify: "start",
                                  alignItem: "center",
                                  children: null
                                }, React.createElement(GridItem$BtsCore.make, {
                                      top: "0",
                                      right: "0",
                                      bottom: "0",
                                      left: "0",
                                      xs: "no",
                                      children: null
                                    }, React.createElement(IconButton$BtsCore.make, {
                                          padding: "8",
                                          disabled: state.showProgress || formitem.formDelete,
                                          onClick: (function (param) {
                                              return Curry._1(showMore, i);
                                            }),
                                          children: null
                                        }, React.createElement(Tooltip$BtsCore.make, {
                                              location: "top",
                                              backgroundColor: "rgba(255,0,0,0.8)",
                                              children: React.createElement(ReactIntl.FormattedMessage, {
                                                    id: "more",
                                                    defaultMessage: "More"
                                                  })
                                            }), React.createElement(IconAction$BtsCore.make, {
                                              animation: "circle",
                                              src: Icons$BtsCore.moreVertBlack
                                            })), tmp$2, React.createElement(BackgroundBoard$BtsCore.make, {
                                          showBackground: formitem.showMore,
                                          backgroundColor: "transparent",
                                          onClick: (function (param) {
                                              return Curry._1(showMore, i);
                                            })
                                        })), React.createElement(GridItem$BtsCore.make, {
                                      top: "0",
                                      right: "0",
                                      bottom: "0",
                                      left: "0",
                                      xs: "no",
                                      children: React.createElement(Switch$BtsCore.make, {
                                            right: "0",
                                            checked: formitem.showCheck,
                                            circleColor: SwitchColor$BtsCore.circle(formitem.showCheck),
                                            linearColor: SwitchColor$BtsCore.linear(formitem.showCheck),
                                            fontColor: SwitchColor$BtsCore.font(formitem.showCheck),
                                            disabled: state.showProgress || formitem.formDelete,
                                            onClick: (function (param) {
                                                return Curry._1(checkItem, i);
                                              }),
                                            children: React.createElement(ReactIntl.FormattedMessage, {
                                                  id: "need",
                                                  defaultMessage: "Need"
                                                })
                                          })
                                    }), React.createElement(GridItem$BtsCore.make, {
                                      style: {
                                        borderRight: "1px solid rgba(0,0,0,0.12)",
                                        marginRight: "12px"
                                      },
                                      left: "0",
                                      xs: "no",
                                      children: null
                                    }), React.createElement(GridItem$BtsCore.make, {
                                      top: "0",
                                      right: "0",
                                      bottom: "0",
                                      left: "0",
                                      xs: "no",
                                      children: React.createElement(IconButton$BtsCore.make, {
                                            padding: "8",
                                            disabled: state.showProgress,
                                            onClick: (function (param) {
                                                return Curry._1(deleteItem, i);
                                              }),
                                            children: null
                                          }, React.createElement(Tooltip$BtsCore.make, {
                                                location: "top",
                                                backgroundColor: "rgba(255,0,0,0.8)",
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: formitem.formDelete ? "refresh" : "deleted",
                                                      defaultMessage: formitem.formDelete ? "Refresh" : "Deleted"
                                                    })
                                              }), React.createElement(IconAction$BtsCore.make, {
                                                animation: "leftRight",
                                                src: formitem.formDelete ? Icons$BtsCore.refreshBlack : Icons$BtsCore.deleteBlack
                                              }))
                                    }), React.createElement(GridItem$BtsCore.make, {
                                      top: "0",
                                      right: "0",
                                      bottom: "0",
                                      left: "0",
                                      xs: "no",
                                      children: React.createElement(IconButton$BtsCore.make, {
                                            padding: "8",
                                            disabled: state.showProgress || formitem.formDelete,
                                            children: null
                                          }, React.createElement(Tooltip$BtsCore.make, {
                                                location: "top",
                                                backgroundColor: "rgba(255,0,0,0.8)",
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: "copy",
                                                      defaultMessage: "Copy"
                                                    })
                                              }), React.createElement(IconAction$BtsCore.make, {
                                                animation: "leftRight",
                                                src: Icons$BtsCore.fileCopyBlack
                                              }))
                                    }), tmp$4)
                          }));
                } else {
                  tmp$1 = null;
                }
                return React.createElement(GridItem$BtsCore.make, {
                            top: "0",
                            right: "24",
                            left: "24",
                            xs: "auto",
                            children: React.createElement(CardOrPaperBoard$BtsCore.make, {
                                  onClick: (function (param) {
                                      return Curry._1(clickBoardPaper, i);
                                    }),
                                  showLine: formitem.showLine,
                                  children: React.createElement(GridContainer$BtsCore.make, {
                                        direction: "column",
                                        justify: "start",
                                        alignItem: "stretch",
                                        children: null
                                      }, React.createElement(GridItem$BtsCore.make, {
                                            top: "0",
                                            bottom: "0",
                                            xs: "auto",
                                            children: React.createElement(GridContainer$BtsCore.make, {
                                                  direction: "row",
                                                  justify: "center",
                                                  alignItem: "center",
                                                  children: null
                                                }, React.createElement(GridItem$BtsCore.make, {
                                                      top: "0",
                                                      right: "0",
                                                      bottom: "0",
                                                      left: "0",
                                                      xs: "auto",
                                                      children: React.createElement(TextFieldStandard$BtsCore.make, {
                                                            top: "0",
                                                            right: "0",
                                                            left: "0",
                                                            value: formitem.title,
                                                            disabled: state.showProgress || formitem.formDelete,
                                                            onChange: (function ($$event) {
                                                                return Curry._2(changeTile, $$event.target.value, i);
                                                              }),
                                                            children: null
                                                          })
                                                    }), formitem.showLine ? React.createElement(React.Fragment, undefined, React.createElement(GridItem$BtsCore.make, {
                                                            top: "0",
                                                            right: "0",
                                                            bottom: "0",
                                                            left: "0",
                                                            xs: "no",
                                                            children: React.createElement(IconButton$BtsCore.make, {
                                                                  padding: "10",
                                                                  disabled: state.showProgress || formitem.formDelete,
                                                                  children: React.createElement(IconAction$BtsCore.make, {
                                                                        animation: "leftRight",
                                                                        src: Icons$BtsCore.collectionsBlack
                                                                      })
                                                                })
                                                          }), React.createElement(GridItem$BtsCore.make, {
                                                            top: "0",
                                                            right: "0",
                                                            bottom: "0",
                                                            left: "0",
                                                            width: "156px",
                                                            xs: "no",
                                                            children: null
                                                          }, React.createElement(SelectOutline$BtsCore.make, {
                                                                top: "0",
                                                                borderColor: "rgba(0,0,0,0.2)",
                                                                value: formitem.outValue,
                                                                disabled: state.showProgress || formitem.formDelete,
                                                                onClick: (function (param) {
                                                                    return Curry._1(showOut, i);
                                                                  }),
                                                                children: /* tuple */[
                                                                  formitem.showOut && !formitem.formDelete ? React.createElement(SelectMenu$BtsCore.make, {
                                                                          top: "50%",
                                                                          transform: "translate(0, -50%)",
                                                                          maxHeight: "280",
                                                                          minHeight: "0",
                                                                          topLeft: "12",
                                                                          topRight: "12",
                                                                          bottomRight: "12",
                                                                          bottomLeft: "12",
                                                                          paddingRight: "8",
                                                                          paddingLeft: "8",
                                                                          children: $$Array.map((function (opticonitem) {
                                                                                  return React.createElement(MenuIcon$BtsCore.make, {
                                                                                              top: "0",
                                                                                              right: "8",
                                                                                              bottom: "0",
                                                                                              left: "8",
                                                                                              disablePadding: opticonitem.opticonPadding,
                                                                                              topLeft: "12",
                                                                                              topRight: "12",
                                                                                              bottomRight: "12",
                                                                                              bottomLeft: "12",
                                                                                              onClick: (function (param) {
                                                                                                  return Curry._2(showValue, opticonitem.value, i);
                                                                                                }),
                                                                                              children: /* tuple */[
                                                                                                React.createElement(IconGeneral$BtsCore.make, {
                                                                                                      src: opticonitem.icon
                                                                                                    }),
                                                                                                opticonitem.value
                                                                                              ]
                                                                                            });
                                                                                }), formitem.opticonitems)
                                                                        }) : null,
                                                                  React.createElement(IconGeneral$BtsCore.make, {
                                                                        animation: IconAnimation$BtsCore.topDownRorate(formitem.showOut),
                                                                        src: Icons$BtsCore.arrowDownBlack
                                                                      })
                                                                ]
                                                              }), React.createElement(BackgroundBoard$BtsCore.make, {
                                                                showBackground: formitem.showOut,
                                                                backgroundColor: "transparent",
                                                                onClick: (function (param) {
                                                                    return Curry._1(showOut, i);
                                                                  })
                                                              }))) : null)
                                          }), React.createElement(GridItem$BtsCore.make, {
                                            top: "0",
                                            bottom: "0",
                                            xs: "auto",
                                            children: tmp
                                          }), tmp$1)
                                })
                          });
              }), state.formitems);
        break;
    case 1 :
        tmp = $$Array.mapi((function (i, settitem) {
                return React.createElement(React.Fragment, undefined, React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "24",
                                bottom: "0",
                                left: "24",
                                xs: "auto",
                                children: React.createElement(GridContainer$BtsCore.make, {
                                      direction: "row",
                                      justify: "center",
                                      alignItem: "center",
                                      children: null
                                    }, React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(TextFieldOutline$BtsCore.make, {
                                                top: "8",
                                                type_: "date",
                                                value: settitem.stdate,
                                                disabled: state.showProgress,
                                                onChange: (function ($$event) {
                                                    return Curry._2(changeStdate, $$event.target.value, i);
                                                  }),
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: "Formor.stdate",
                                                      defaultMessage: "Stdate"
                                                    })
                                              })
                                        }), React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(TextFieldOutline$BtsCore.make, {
                                                top: "8",
                                                type_: "time",
                                                value: settitem.sttime,
                                                disabled: state.showProgress,
                                                onChange: (function ($$event) {
                                                    return Curry._2(changeSttime, $$event.target.value, i);
                                                  }),
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: "Formor.sttime",
                                                      defaultMessage: "Sttime"
                                                    })
                                              })
                                        }))
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "24",
                                bottom: "0",
                                left: "24",
                                xs: "auto",
                                children: React.createElement(GridContainer$BtsCore.make, {
                                      direction: "row",
                                      justify: "center",
                                      alignItem: "center",
                                      children: null
                                    }, React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(TextFieldOutline$BtsCore.make, {
                                                top: "8",
                                                type_: "date",
                                                value: settitem.endate,
                                                disabled: state.showProgress,
                                                onChange: (function ($$event) {
                                                    return Curry._2(changeEndate, $$event.target.value, i);
                                                  }),
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: "Formor.endate",
                                                      defaultMessage: "Endate"
                                                    })
                                              })
                                        }), React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(TextFieldOutline$BtsCore.make, {
                                                top: "8",
                                                type_: "time",
                                                value: settitem.entime,
                                                disabled: state.showProgress,
                                                onChange: (function ($$event) {
                                                    return Curry._2(changeEntime, $$event.target.value, i);
                                                  }),
                                                children: React.createElement(ReactIntl.FormattedMessage, {
                                                      id: "Formor.entime",
                                                      defaultMessage: "Entme"
                                                    })
                                              })
                                        }))
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "0",
                                bottom: "0",
                                left: "30",
                                xs: "auto",
                                children: React.createElement(Switch$BtsCore.make, {
                                      right: "0",
                                      checked: settitem.showExam,
                                      circleColor: SwitchColor$BtsCore.circle(settitem.showExam),
                                      linearColor: SwitchColor$BtsCore.linear(settitem.showExam),
                                      fontColor: SwitchColor$BtsCore.font(settitem.showExam),
                                      disabled: state.showProgress,
                                      onClick: (function (param) {
                                          return Curry._1(showExam, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.examed",
                                            defaultMessage: "Examed"
                                          })
                                    })
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "0",
                                bottom: "0",
                                left: "80",
                                xs: "auto",
                                children: React.createElement(Switch$BtsCore.make, {
                                      right: "0",
                                      checked: settitem.randOption,
                                      circleColor: SwitchColor$BtsCore.circle(settitem.randOption),
                                      linearColor: SwitchColor$BtsCore.linear(settitem.randOption),
                                      fontColor: SwitchColor$BtsCore.font(settitem.randOption),
                                      disabled: state.showProgress || !settitem.showExam,
                                      onClick: (function (param) {
                                          return Curry._1(randOption, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.randopt",
                                            defaultMessage: "Randopt"
                                          })
                                    })
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "0",
                                bottom: "0",
                                left: "80",
                                xs: "auto",
                                children: React.createElement(Switch$BtsCore.make, {
                                      right: "0",
                                      checked: settitem.randSubtile,
                                      circleColor: SwitchColor$BtsCore.circle(settitem.randSubtile),
                                      linearColor: SwitchColor$BtsCore.linear(settitem.randSubtile),
                                      fontColor: SwitchColor$BtsCore.font(settitem.randSubtile),
                                      disabled: state.showProgress || !settitem.showExam,
                                      onClick: (function (param) {
                                          return Curry._1(randSubtile, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.randsub",
                                            defaultMessage: "Randsub"
                                          })
                                    })
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "0",
                                bottom: "0",
                                left: "80",
                                xs: "auto",
                                children: React.createElement(Switch$BtsCore.make, {
                                      right: "0",
                                      checked: settitem.showRestart,
                                      circleColor: SwitchColor$BtsCore.circle(settitem.showRestart),
                                      linearColor: SwitchColor$BtsCore.linear(settitem.showRestart),
                                      fontColor: SwitchColor$BtsCore.font(settitem.showRestart),
                                      disabled: state.showProgress || !settitem.showExam,
                                      onClick: (function (param) {
                                          return Curry._1(showRestart, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.restart",
                                            defaultMessage: "Restart"
                                          })
                                    })
                              }), React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "0",
                                bottom: "0",
                                left: "80",
                                xs: "no",
                                children: React.createElement(TextFieldOutline$BtsCore.make, {
                                      type_: "number",
                                      value: settitem.number,
                                      disabled: state.showProgress || !settitem.showExam,
                                      onChange: (function ($$event) {
                                          return Curry._2(changeNumber, $$event.target.value, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.number",
                                            defaultMessage: "Number"
                                          })
                                    })
                              }));
              }), state.settitems);
        break;
    case 2 :
        tmp = $$Array.mapi((function (i, settitem) {
                return React.createElement(React.Fragment, undefined, React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "24",
                                left: "24",
                                xs: "auto",
                                children: React.createElement(Switch$BtsCore.make, {
                                      right: "0",
                                      checked: settitem.showLimit,
                                      circleColor: SwitchColor$BtsCore.circle(settitem.showLimit),
                                      linearColor: SwitchColor$BtsCore.linear(settitem.showLimit),
                                      fontColor: SwitchColor$BtsCore.font(settitem.showLimit),
                                      disabled: state.showProgress,
                                      onClick: (function (param) {
                                          return Curry._2(showLimit, settitem.showLimit, i);
                                        }),
                                      children: React.createElement(ReactIntl.FormattedMessage, {
                                            id: "Formor.limit",
                                            defaultMessage: "Limit"
                                          })
                                    })
                              }), settitem.showLimit ? React.createElement(GridItem$BtsCore.make, {
                                  style: {
                                    height: "2500px"
                                  },
                                  top: "0",
                                  right: "24",
                                  bottom: "0",
                                  left: "24",
                                  xs: "auto",
                                  children: $$Array.mapi((function (di, dertitem) {
                                          return React.createElement(ExpansionPanel$BtsCore.make, {
                                                      showPanel: dertitem.showPanel,
                                                      children: /* tuple */[
                                                        React.createElement(ExpansionSummary$BtsCore.make, {
                                                              showSummary: dertitem.showPanel,
                                                              onClick: (function (param) {
                                                                  return Curry._4(showPanel, dertitem.dertment, i, di, dertitem.operitems);
                                                                }),
                                                              children: /* tuple */[
                                                                React.createElement(ExpansionBasis$BtsCore.make, {
                                                                      children: React.createElement(Typography$BtsCore.make, {
                                                                            variant: "subheading",
                                                                            color: "rgba(0,0,0,0.8)",
                                                                            children: dertitem.dertment
                                                                          })
                                                                    }),
                                                                React.createElement(IconGeneral$BtsCore.make, {
                                                                      src: dertitem.showPanel ? Icons$BtsCore.arrowUpBlack : Icons$BtsCore.arrowDownBlack
                                                                    })
                                                              ]
                                                            }),
                                                        React.createElement(GridContainer$BtsCore.make, {
                                                              direction: "column",
                                                              justify: "start",
                                                              alignItem: "stretch",
                                                              children: $$Array.mapi((function (oi, operitem) {
                                                                      return React.createElement(GridItem$BtsCore.make, {
                                                                                  right: "0",
                                                                                  bottom: "0",
                                                                                  left: "0",
                                                                                  xs: "auto",
                                                                                  children: React.createElement(GridContainer$BtsCore.make, {
                                                                                        direction: "row",
                                                                                        justify: "center",
                                                                                        alignItem: "center",
                                                                                        children: null
                                                                                      }, React.createElement(GridItem$BtsCore.make, {
                                                                                            top: "0",
                                                                                            right: "0",
                                                                                            bottom: "0",
                                                                                            left: "0",
                                                                                            xs: "auto",
                                                                                            children: React.createElement(Typography$BtsCore.make, {
                                                                                                  variant: "body1",
                                                                                                  color: "rgba(0,0,0,0.8)",
                                                                                                  children: operitem.userid
                                                                                                })
                                                                                          }), React.createElement(GridItem$BtsCore.make, {
                                                                                            top: "0",
                                                                                            right: "0",
                                                                                            bottom: "0",
                                                                                            left: "0",
                                                                                            xs: "auto",
                                                                                            children: React.createElement(Typography$BtsCore.make, {
                                                                                                  variant: "body1",
                                                                                                  color: "rgba(0,0,0,0.8)",
                                                                                                  children: operitem.name
                                                                                                })
                                                                                          }), React.createElement(GridItem$BtsCore.make, {
                                                                                            top: "0",
                                                                                            bottom: "0",
                                                                                            xs: "no",
                                                                                            children: React.createElement(Switch$BtsCore.make, {
                                                                                                  right: "0",
                                                                                                  checked: operitem.showOper,
                                                                                                  circleColor: SwitchColor$BtsCore.circle(operitem.showOper),
                                                                                                  linearColor: SwitchColor$BtsCore.linear(operitem.showOper),
                                                                                                  fontColor: SwitchColor$BtsCore.font(operitem.showOper),
                                                                                                  disabled: state.showProgress,
                                                                                                  onClick: (function (param) {
                                                                                                      return Curry._3(showOper, i, di, oi);
                                                                                                    }),
                                                                                                  children: React.createElement(ReactIntl.FormattedMessage, {
                                                                                                        id: "add",
                                                                                                        defaultMessage: "Add"
                                                                                                      })
                                                                                                })
                                                                                          }))
                                                                                });
                                                                    }), dertitem.operitems)
                                                            })
                                                      ]
                                                    });
                                        }), settitem.dertitems)
                                }) : null);
              }), state.settitems);
        break;
    case 3 :
        tmp = $$Array.mapi((function (i, viewitem) {
                return React.createElement(React.Fragment, undefined, React.createElement(GridItem$BtsCore.make, {
                                top: "0",
                                right: "24",
                                left: "24",
                                xs: "auto",
                                children: React.createElement(GridContainer$BtsCore.make, {
                                      direction: "row",
                                      justify: "center",
                                      alignItem: "center",
                                      children: null
                                    }, React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(Typography$BtsCore.make, {
                                                variant: "body1",
                                                color: "rgba(0,0,0,0.8)",
                                                children: viewitem.vuserid
                                              })
                                        }), React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(Typography$BtsCore.make, {
                                                variant: "body1",
                                                color: "rgba(0,0,0,0.8)",
                                                children: viewitem.vname
                                              })
                                        }), React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(Typography$BtsCore.make, {
                                                variant: "body1",
                                                color: "rgba(0,0,0,0.8)",
                                                children: viewitem.writed
                                              })
                                        }), React.createElement(GridItem$BtsCore.make, {
                                          top: "0",
                                          right: "0",
                                          bottom: "0",
                                          left: "0",
                                          xs: "auto",
                                          children: React.createElement(Typography$BtsCore.make, {
                                                variant: "body1",
                                                color: "rgba(0,0,0,0.8)",
                                                children: viewitem.score
                                              })
                                        }))
                              }));
              }), state.viewitems);
        break;
    default:
      tmp = null;
  }
  return React.createElement(React.Fragment, undefined, React.createElement(NewFacetube$BtsCore.make, {
                  showProgress: state.showProgress,
                  error: state.error,
                  children: React.createElement(GridItem$BtsCore.make, {
                        style: Together$BtsCore.marginAuto,
                        top: "0",
                        right: "32",
                        bottom: "0",
                        left: "32",
                        xs: "12",
                        children: React.createElement(GridContainer$BtsCore.make, {
                              direction: "column",
                              justify: "center",
                              alignItem: "stretch",
                              children: null
                            }, React.createElement(GridItem$BtsCore.make, {
                                  top: "0",
                                  right: "24",
                                  bottom: "0",
                                  left: "24",
                                  xs: "auto",
                                  children: React.createElement(Tabs$BtsCore.make, {
                                        id: "bus-",
                                        index: state.index,
                                        short: 20,
                                        height: "3",
                                        children: $$Array.of_list(List.mapi((function (i, tabtitem) {
                                                    return React.createElement(Tab$BtsCore.make, {
                                                                showTab: tabtitem.showTabt,
                                                                maxWidth: "111.6",
                                                                borderRadius: "15",
                                                                id: "bus-" + String(i),
                                                                animationName: "none",
                                                                onClick: (function (param) {
                                                                    return Curry._2(clickItemTab, i, tabtitem.tabPath);
                                                                  }),
                                                                children: React.createElement(IconAction$BtsCore.make, {
                                                                      width: "28",
                                                                      height: "28",
                                                                      animation: "leftRight",
                                                                      src: tabtitem.tabImage
                                                                    })
                                                              });
                                                  }), state.tabitems))
                                      })
                                }), React.createElement(GridItem$BtsCore.make, {
                                  right: "24",
                                  bottom: "0",
                                  left: "24",
                                  xs: "auto",
                                  children: React.createElement(GridContainer$BtsCore.make, {
                                        direction: "row",
                                        justify: "start",
                                        alignItem: "center",
                                        children: $$Array.map((function (item) {
                                                return React.createElement("div", {
                                                            onClick: (function (param) {
                                                                return Curry._1(clickFormBoard, item.id);
                                                              })
                                                          }, React.createElement(GridItem$BtsCore.make, {
                                                                style: {
                                                                  height: "246px",
                                                                  marginRight: "12px"
                                                                },
                                                                top: "0",
                                                                right: "0",
                                                                bottom: "0",
                                                                left: "0",
                                                                width: "210px",
                                                                cursor: "pointer",
                                                                enterBorderWidth: "2",
                                                                borderWidth: "2",
                                                                enterBorderColor: "rgba(255,0,0,0.8)",
                                                                borderRadius: "1",
                                                                xs: "no",
                                                                children: React.createElement(Card$BtsCore.make, {
                                                                      children: React.createElement(GridContainer$BtsCore.make, {
                                                                            direction: "column",
                                                                            justify: "center",
                                                                            alignItem: "stretch",
                                                                            children: null
                                                                          }, React.createElement(GridItem$BtsCore.make, {
                                                                                top: "0",
                                                                                right: "0",
                                                                                bottom: "0",
                                                                                left: "0",
                                                                                xs: "auto",
                                                                                children: React.createElement("div", {
                                                                                      style: {
                                                                                        height: "175px"
                                                                                      }
                                                                                    })
                                                                              }), React.createElement(GridItem$BtsCore.make, {
                                                                                top: "0",
                                                                                right: "12",
                                                                                bottom: "0",
                                                                                left: "16",
                                                                                width: "180px",
                                                                                xs: "no",
                                                                                children: React.createElement(Typography$BtsCore.make, {
                                                                                      variant: "subtitle1",
                                                                                      noWrap: true,
                                                                                      children: item.tile
                                                                                    })
                                                                              }), React.createElement(GridItem$BtsCore.make, {
                                                                                top: "0",
                                                                                right: "12",
                                                                                bottom: "0",
                                                                                left: "16",
                                                                                xs: "no",
                                                                                children: React.createElement(GridContainer$BtsCore.make, {
                                                                                      direction: "row",
                                                                                      justify: "center",
                                                                                      alignItem: "center",
                                                                                      children: null
                                                                                    }, React.createElement(GridItem$BtsCore.make, {
                                                                                          top: "0",
                                                                                          right: "8",
                                                                                          bottom: "0",
                                                                                          left: "0",
                                                                                          xs: "no",
                                                                                          children: React.createElement(IconAction$BtsCore.make, {
                                                                                                animation: "leftRight",
                                                                                                src: Icons$BtsCore.dateRangeBlack
                                                                                              })
                                                                                        }), React.createElement(GridItem$BtsCore.make, {
                                                                                          top: "0",
                                                                                          right: "0",
                                                                                          bottom: "0",
                                                                                          left: "0",
                                                                                          xs: "auto",
                                                                                          children: React.createElement(Typography$BtsCore.make, {
                                                                                                variant: "subtitle2",
                                                                                                children: item.datetime
                                                                                              })
                                                                                        }), React.createElement(GridItem$BtsCore.make, {
                                                                                          top: "0",
                                                                                          right: "0",
                                                                                          bottom: "0",
                                                                                          left: "0",
                                                                                          xs: "no",
                                                                                          children: React.createElement(IconButton$BtsCore.make, {
                                                                                                padding: "3",
                                                                                                disabled: state.showProgress,
                                                                                                children: null
                                                                                              }, React.createElement(Tooltip$BtsCore.make, {
                                                                                                    location: "top",
                                                                                                    backgroundColor: "rgba(255,0,0,0.8)",
                                                                                                    children: React.createElement(ReactIntl.FormattedMessage, {
                                                                                                          id: "more",
                                                                                                          defaultMessage: "More"
                                                                                                        })
                                                                                                  }), React.createElement(IconAction$BtsCore.make, {
                                                                                                    animation: "leftRight",
                                                                                                    src: Icons$BtsCore.moreVertBlack
                                                                                                  }))
                                                                                        }))
                                                                              }))
                                                                    })
                                                              }));
                                              }), state.items)
                                      })
                                }))
                      })
                }), React.createElement(CircleButton$BtsCore.make, {
                  style: {
                    bottom: "25px",
                    position: "fixed",
                    right: "25px"
                  },
                  onClick: showAnimationRight,
                  children: null
                }, React.createElement(Tooltip$BtsCore.make, {
                      location: "top",
                      backgroundColor: "rgba(255,0,0,0.8)",
                      children: React.createElement(ReactIntl.FormattedMessage, {
                            id: "Proform.import",
                            defaultMessage: "Import"
                          })
                    }), React.createElement(IconAction$BtsCore.make, {
                      animation: "leftRight",
                      src: Icons$BtsCore.importExportWhite
                    })), React.createElement(DialogAnimationRight$BtsCore.make, {
                  showAnimation: state.showRight,
                  children: null
                }, React.createElement(DialogTitle$BtsCore.make, {
                      backgroundColor: "rgba(255,0,0,1)",
                      color: "rgba(255,255,255,1)",
                      children: React.createElement(ReactIntl.FormattedMessage, {
                            id: "Proform.upload",
                            defaultMessage: "Upload"
                          })
                    }), React.createElement(DialogContent$BtsCore.make, {
                      right: "0",
                      bottom: "12",
                      left: "0",
                      children: React.createElement(DialogContentText$BtsCore.make, {
                            children: React.createElement(GridItem$BtsCore.make, {
                                  top: "30",
                                  right: "25",
                                  left: "25",
                                  xs: "12",
                                  children: React.createElement(GeneralUpload$BtsCore.make, {
                                        webLoad: state.showProgress,
                                        showDrop: state.showDrop,
                                        fileRef: fileRef,
                                        onDragOver: Curry.__1(dragOver),
                                        onDragLeave: Curry.__1(dragLeave),
                                        onDrop: (function ($$event) {
                                            return Curry._2(dropFile, $$event, Caml_array.caml_array_get($$event.nativeEvent.dataTransfer.files, 0));
                                          }),
                                        disabled: state.showProgress,
                                        onClick: chooseFile,
                                        onChange: (function ($$event) {
                                            return Curry._1(uploadFile, Caml_array.caml_array_get($$event.target.files, 0));
                                          })
                                      })
                                })
                          })
                    }), React.createElement(DialogActions$BtsCore.make, {
                      top: "0",
                      right: "16",
                      bottom: "12",
                      left: "16",
                      children: React.createElement(GridContainer$BtsCore.make, {
                            direction: "rowReverse",
                            justify: "start",
                            alignItem: "center",
                            children: React.createElement(GridItem$BtsCore.make, {
                                  top: "0",
                                  bottom: "0",
                                  xs: "no",
                                  children: React.createElement(Button$BtsCore.make, {
                                        disabled: state.showProgress,
                                        onClick: closeAnimationRight,
                                        children: null
                                      }, React.createElement(IconAction$BtsCore.make, {
                                            animation: "circle",
                                            src: Icons$BtsCore.clearWhite
                                          }), React.createElement(ReactIntl.FormattedMessage, {
                                            id: "closed",
                                            defaultMessage: "Closed"
                                          }))
                                })
                          })
                    })), React.createElement(DialogFull$BtsCore.make, {
                  showAnimation: state.showFull,
                  children: null
                }, React.createElement(DialogTitle$BtsCore.make, {
                      top: "6",
                      left: "64",
                      children: React.createElement(TextFieldStandard$BtsCore.make, {
                            width: "25",
                            top: "0",
                            right: "0",
                            bottom: "0",
                            left: "0",
                            value: state.formTile,
                            disabled: state.showProgress,
                            onChange: (function ($$event) {
                                return Curry._1(changeFormTile, $$event.target.value);
                              }),
                            children: null
                          })
                    }), React.createElement(DialogContent$BtsCore.make, {
                      children: React.createElement(DialogContentText$BtsCore.make, {
                            children: React.createElement(GridItem$BtsCore.make, {
                                  style: Together$BtsCore.marginAuto,
                                  top: "0",
                                  right: "0",
                                  bottom: "0",
                                  left: "54",
                                  xs: "12",
                                  maxWidth: "770px",
                                  children: React.createElement(GridContainer$BtsCore.make, {
                                        direction: "column",
                                        justify: "center",
                                        alignItem: "stretch",
                                        children: null
                                      }, React.createElement(GridItem$BtsCore.make, {
                                            style: {
                                              position: "sticky",
                                              top: "0px",
                                              zIndex: "1000"
                                            },
                                            top: "0",
                                            right: "24",
                                            left: "24",
                                            xs: "auto",
                                            children: React.createElement(GridContainer$BtsCore.make, {
                                                  direction: "row",
                                                  justify: "around",
                                                  alignItem: "center",
                                                  children: null
                                                }, React.createElement(GridItem$BtsCore.make, {
                                                      top: "0",
                                                      right: "0",
                                                      bottom: "0",
                                                      left: "0",
                                                      xs: "auto",
                                                      children: React.createElement(Tabs$BtsCore.make, {
                                                            id: "report-",
                                                            index: state.formindex,
                                                            height: "3",
                                                            children: $$Array.of_list(List.mapi((function (i, formtabitem) {
                                                                        return React.createElement(Tab$BtsCore.make, {
                                                                                    showTab: formtabitem.showTab,
                                                                                    maxWidth: "111.6",
                                                                                    borderRadius: "15",
                                                                                    id: "report-" + String(i),
                                                                                    animationName: "none",
                                                                                    onClick: (function (param) {
                                                                                        return Curry._1(clickFormTab, i);
                                                                                      }),
                                                                                    children: React.createElement(IconAction$BtsCore.make, {
                                                                                          width: "28",
                                                                                          height: "28",
                                                                                          animation: "leftRight",
                                                                                          src: formtabitem.tabImage
                                                                                        })
                                                                                  });
                                                                      }), state.formtabitems))
                                                          })
                                                    }), React.createElement(GridItem$BtsCore.make, {
                                                      top: "0",
                                                      right: "0",
                                                      bottom: "0",
                                                      left: "0",
                                                      xs: "no",
                                                      children: React.createElement(Button$BtsCore.make, {
                                                            disabled: state.showProgress,
                                                            onClick: addForm,
                                                            children: null
                                                          }, React.createElement(IconAction$BtsCore.make, {
                                                                animation: "circle",
                                                                src: Icons$BtsCore.addWhite
                                                              }), React.createElement(ReactIntl.FormattedMessage, {
                                                                id: "add",
                                                                defaultMessage: "Add"
                                                              }))
                                                    }), React.createElement(GridItem$BtsCore.make, {
                                                      top: "0",
                                                      right: "0",
                                                      bottom: "0",
                                                      left: "0",
                                                      xs: "no",
                                                      children: React.createElement(Button$BtsCore.make, {
                                                            disabled: state.showProgress,
                                                            onClick: insertForm,
                                                            children: null
                                                          }, React.createElement(IconAction$BtsCore.make, {
                                                                animation: "leftRight",
                                                                src: Icons$BtsCore.saveWhite
                                                              }), React.createElement(ReactIntl.FormattedMessage, {
                                                                id: "save",
                                                                defaultMessage: "Save"
                                                              }))
                                                    }), React.createElement(GridItem$BtsCore.make, {
                                                      top: "0",
                                                      right: "0",
                                                      bottom: "0",
                                                      left: "0",
                                                      xs: "no",
                                                      children: React.createElement(Button$BtsCore.make, {
                                                            disabled: state.showProgress,
                                                            onClick: deleteForm,
                                                            children: null
                                                          }, React.createElement(IconAction$BtsCore.make, {
                                                                animation: "leftRight",
                                                                src: Icons$BtsCore.deleteWhite
                                                              }), React.createElement(ReactIntl.FormattedMessage, {
                                                                id: "deleted",
                                                                defaultMessage: "Deleted"
                                                              }))
                                                    }))
                                          }), tmp)
                                })
                          })
                    }), React.createElement(DialogActions$BtsCore.make, {
                      children: React.createElement("div", {
                            style: {
                              left: "10px",
                              position: "fixed",
                              top: "10px"
                            }
                          }, React.createElement(IconButton$BtsCore.make, {
                                padding: "12",
                                disabled: state.showProgress,
                                onClick: closeAnimationFull,
                                children: null
                              }, React.createElement(Tooltip$BtsCore.make, {
                                    location: "bottom",
                                    backgroundColor: "rgba(255,0,0,0.8)",
                                    children: React.createElement(ReactIntl.FormattedMessage, {
                                          id: "closed",
                                          defaultMessage: "Closed"
                                        })
                                  }), React.createElement(IconAction$BtsCore.make, {
                                    animation: "circle",
                                    src: Icons$BtsCore.clearBlack
                                  })))
                    })), React.createElement(SnackbarYoutube$BtsCore.make, {
                  showYoutube: state.showYoutube,
                  position: "bottomLeft",
                  children: /* tuple */[
                    React.createElement("span", undefined, state.youtubeText),
                    null
                  ]
                }));
}

var make = Proform;

export {
  newitem ,
  newansweritem ,
  reducer ,
  initialState ,
  make ,
  
}
/*  Not a pure module */
